##### SSDP
#alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"GPL MISC UPnP service discover attempt"; content:"M-SEARCH "; depth:9; content:"ssdp|3A|discover"; classtype:network-scan; sid:2101917; rev:7; metadata:created_at 2010_09_23, updated_at 2010_09_23;)

#alert udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"ET SCAN External to Internal UPnP Request udp port 1900"; content:"MSEARCH * HTTP/1.1"; depth:18; content:"MAN|3a| ssdp|3a|"; nocase; distance:0; reference:url,www.upnp-hacks.org/upnp.html; reference:url,doc.emergingthreats.net/2008094; classtype:attempted-recon; sid:2008094; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30;)

#alert udp any any -> $HOME_NET 1900 (msg:"ET DOS Possible SSDP Amplification Scan in Progress"; content:"M-SEARCH * HTTP/1.1"; content:"ST|3a 20|ssdp|3a|all|0d 0a|"; nocase; distance:0; fast_pattern; threshold: type both,track by_src,count 2,seconds 60; reference:url,community.rapid7.com/community/metasploit/blog/2014/08/29/weekly-metasploit-update; classtype:attempted-dos; sid:2019102; rev:1; metadata:created_at 2014_09_02, updated_at 2014_09_02;)

drop udp $EXTERNAL_NET 1900 -> $HOME_NET any (msg:"ET DOS Possible SSDP Response"; content:"HTTP/1.1|20|200|20|OK"; nocase; threshold: type both,track by_src,count 2,seconds 60; classtype:attempted-dos; sid:1061; rev:1;)

drop udp $EXTERNAL_NET any -> $HOME_NET 1900 (msg:"ET DOS Possible SSDP Query ssdp:all"; content:"M-SEARCH|20|*|20|HTTP/1.1"; nocase; fast_pattern; content:"ST:ssdp:all";threshold: type both,track by_src,count 2,seconds 60; classtype:attempted-dos; sid:1062; rev:1;)
